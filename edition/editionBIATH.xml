<?xml version="1.0" encoding="UTF-8"?>

<!-- Menu Editions Activité "Biathlon" !-->
<!-- version="4.4" !-->
<!-- calcul de la note poursuite 2éme jour !-->
<!-- si possible de faire fonctionner les cond="discipline:In('POURS')" dans les menus ??  -->
<!-- verifier l'ordre en cas d'axeco -->
<edition>
	
	<menu>
		<menu title="Listes des Participants " image="./res/32x32_juges.png">
			<menu title="Par Ordre Alphabétique" image="./res/16x16_juges.png" id="part_officiel" />
			<menu title="Par Ordre de Points" image="./res/16x16_juges.png" id="part_officiel_points" />
			<menu title="Par Nation / Alphabétique" image="./res/16x16_juges.png" page_break="1" orderby="Nation" id="participants" />
			<menu title="Par Comité / Alphabétique" image="./res/16x16_juges.png" page_break="1" orderby="Comite" id="participants" />
			<menu title="Par Club / Alphabétique" image="./res/16x16_juges.png" page_break="1" orderby="Club" id="participants" />
			<menu title="Par Epreuve" image="./res/16x16_juges.png" id="part_epreuve" />
		</menu>
		
		<menu title="Listes de Départ" image="./res/32x32_bib.png">
			<menu title="Liste de départ" image="./res/16x16_official.png" header="1" first_header="0" id="lst_officielle" officiel="0"/>
			<menu title="Liste de départ Officielle" image="./res/16x16_official.png" id="lst_officielle" Qrcode="0" officiel="1"/>
			<menu title="Liste de départ avec Qrcode Live" image="./res/16x16_official.png" id="lst_officielle" first_header="0" Qrcode="1" officiel="1"/>
			<menu title="Officielle poursuite" image="./res/16x16_official.png" id="lst_officielle_pours" choix_manche="1" cond="discipline:In('POURS')"/>
			<menu title="Liste de départ Par Nation" image="./res/16x16_bib.png" page_break="1" orderby="Nation" id="lst_officielle_Filtrer"/>
			<menu title="Liste de départ Par Comite" image="./res/16x16_bib.png" page_break="1" orderby="Comite" id="lst_officielle_Filtrer"/>
			<menu title="Liste de départ Par Club" image="./res/16x16_bib.png" page_break="1" orderby="Club" id="lst_officielle_Filtrer"/>
			<menu title="Liste de départ Par Epreuve (speaker)" image="./res/16x16_bib.png" id="lst_officielle_epreuve"/>
			<menu title="Edition des couloirs" image="./res/16x16_text.png" lua="./edition/couloir.lua" cond="discipline:In('POURS')" />
		</menu>
		
		<menu title="Résultats (Jour 1 et Poursuite) " image="./res/32x32_ranking.png">
			<menu title="Résultats Provisoire" image="./res/16x16_ranking.png" id="res_officiel" first_header="0" officiel="0"/>
			<menu title="Résultats Officieux" image="./res/16x16_ranking.png" id="res_officiel" first_header="0" officiel="0" />
			<menu title="Résultats Officiels" image="./res/16x16_official.png" id="res_officiel" officiel="1" />
			<menu title="Résultats Officiels poursuite 2éme Jour" image="./res/16x16_official.png" id="res_off_Pours" officiel="1" />
			<menu title="Résultats par épreuve / catégories et sexe" image="./res/16x16_ranking.png" id="res_categ" header="1" first_header="0" choix_clt_max="1"/>
			<menu title="Multi épreuve(poursuite)" image="./res/16x16_juges.png"  id="res_epr2"/>
		</menu>
		
		<menu title="Homologation" image="./res/32x32_options.png">
			<!-- <menu title="Calcul de la Pénalitée" image="./res/16x16_calc.png" id="penalite"  /> -->
			<menu title="Edition Homologation" image="./res/16x16_text.png" id="Homologation"  />
		</menu>
		
	</menu>

	<!-- header standard !-->
	<header>
		<lua>type_edition = id:sub(1,4)
			 entite = $(Evenement.Code_entite)
			 discipline = $(Epreuve.Code_discipline)
		</lua>
		<spacing all="0"/>
		<background mode="transparent"/>
		<font name="Calibri" size="14" adjust="max" weight="bold"/>
		<text row="auto" col="1" align="center">$(Evenement.Nom)</text>
		<text row="auto" align="center">$(Discipline.Libelle)</text>
		<text row="auto" align="center" cond="params.code_epreuve ~= -1">$(Categorie{$(Epreuve.Code_categorie)}.Libelle)..' - '..$(Sexe{$(Epreuve.Sexe)}.Libelle)</text>
		<text row="auto" align="center" cond="title" >title</text>
		<row h="1.5cm"/>
		<matrix row_start="-3" row_end="0" col_start="10" col_end="0">
			<row h="1.5cm" />
			<col w="1, 1.5cm" />
			<qrcode adjust="best" col_start="2" cond="tonumber(params.Qrcode)==1 and entite=='FFS' ">'https://live.ffs.fr/live_timing/live_cc.php?codex='..$(Epreuve.Fichier_transfert)</qrcode>
			<qrcode adjust="best" col_start="2" cond="tonumber(params.Qrcode)==1 and entite=='FIS' and $(Evenement.Commentaire_live):len() &gt; 0">'live.fis-ski.com/lv-al'..string.sub($(Epreuve.Fichier_transfert),4)..'.htm#/short'</qrcode>
		</matrix>
		<!-- affichage de la ligne d'heure de départ en massstart ou fond pop si pas de first header -->
		<lua>if type_edition == 'lst_' and first_header == '0' then</lua>
		<call option="Ligne_H_depart" cond="editor:GetPageCurrent() == 1" file="./edition/options.xml"/>
		<lua>end</lua>
		
		<!-- affichage du Compteur des classés si c'est un resultat (id commence par 'res_' et si le first header n'est pas actif) -->
		<lua>if type_edition == 'res_' and first_header == '0' then</lua>
			<call option="stat_ranking" cond="editor:GetPageCurrent() == 1" file="./edition/options.xml"/>
		<lua>end</lua>
	</header>
	
	<!-- first_header standard !-->
	<first_header >
		<background mode="transparent"/>
		<font name="Calibri" size="9" adjust="best" weight="normal"/>
		<pen border="none" />
		<call option="identiteOfficiel" file="./edition/options.xml"/>
		<lua>type_edition = id:sub(1,4)</lua>
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>discipline = $(Epreuve.Code_discipline)</lua>
		<col w="5,5,1, 0.2cm,4,4,1, 0.2cm,4,4,1" />

		<row h="auto" />
		<text col_start="1" col_end="3" align="center" underlined="1" font_size_step="1" font_weight="bold">'JURY DE COMPETITION'</text>
		<text col_start="5" col_end="7" align="center" underlined="1" font_size_step="1" font_weight="bold">'CARACTERISTIQUES DE LA PISTE'</text>
		<text col_start="9" col_end="11" align="center" underlined="1" font_size_step="1" font_weight="bold">'RENSEIGNEMENTS'</text>
		<row h="0.1cm" />

		<row h="auto" />
		<text col_start="1" align="left">'DELEGUE TECHNIQUE '..entite..':'</text>
		<text col_start="2" col_end="3" align="left">GetIdentiteOfficiels('TechnicalDelegate')</text>
		<text col_start="5" align="left" >'Nom du Site :'</text>
		<text col_start="6" align="left" >$(Pistes.Nom_piste)</text>
		<text col_start="9" align="left">'Lieu :'</text>
		<text col_start="10" col_end="0" align="right" >$(Epreuve_Nordique.Lieu)</text>
	
		<row h="auto" />
		<text col_start="1" align="left">'DT Adjoint :'</text>
		<text col_start="2" col_end="3" align="left">GetIdentiteOfficiels('TECHNICALDELEGATEASSISTANT')</text>
		<text col_start="5" align="left" >'Point Haut :'</text>
		<text col_start="6" align="left" >$(Epreuve.Point_haut)</text>
		<text col_start="9" align="left">'Categorie :'</text>
		<text col_start="10" col_end="0" align="right" >$(Categorie{$(Epreuve.Code_categorie)}.Libelle)</text>

		<row h="auto" />
		<text col_start="1" align="left">'DIRECTEUR D\'EPREUVE :'</text>
		<text col_start="2" col_end="3" align="left">GetIdentiteOfficiels('RACEDIRECTOR')</text>
		<text col_start="5" align="left" >'Point Bas :'</text>
		<text col_start="6" align="left" >$(Epreuve.Point_bas)</text>
		<text col_start="9" align="left">'Sexe :'</text>
		<text col_start="10" col_end="0" align="right" >$(Sexe{$(Epreuve.Sexe)}.Libelle)</text>
		
		<row h="auto" />
		<text col_start="1" align="left">'CHEF DE PISTE :'</text>
		<text col_start="2" col_end="3" align="left">GetIdentiteOfficiels('ChiefCompetition')</text>
		<text col_start="5" align="left" >'Montée maxi. :'</text>
		<text col_start="6" align="left" >$(Epreuve.Montee_maxi)</text>
		<text col_start="9" align="left">'Distance épreuve :'</text>
		<text col_start="10" col_end="0" align="right" >$(Epreuve.Distance):Suffix(' Km')</text>
		
		<row h="auto" />
		<text col_start="1" align="left">'COORDONNATEUR- '..entite..':'</text>
		<text col_start="2" align="left">GetIdentiteOfficiels('ffs_coordinateur')</text>
		<text col_start="5" align="left" >'Montée Totale. :'</text>
		<text col_start="6" align="left" >$(Epreuve.Montee_tot)</text>
		<text col_start="9" align="left">'Style :'</text>
		<lua>if $(Epreuve.Style) == 'L' then Style = 'Libre' </lua>
		<lua>elseif $(Epreuve.Style) == 'C' then Style = 'Classique' </lua>
		<lua>elseif $(Epreuve.Style) == 'X' then Style = 'Classique + Libre' </lua>
		<lua>elseif $(Epreuve.Style) == 'Y' then Style = 'Libre + Classique' end </lua>
		<text col_start="10" col_end="0" align="right" >Style</text>
		
		<row h="auto" />
		<text col_start="1" align="left">'Resp. pas de tir:'</text>
		<text col_start="2" align="left">$(Epreuve_Nordique.JugeA)..''..$(Epreuve_Nordique.Code_nation_jugeA):Parenthesis()</text>
		<text col_start="5" align="left" >'Type de tir:'</text>
		<text col_start="6" align="left" >$(Epreuve.Tir)</text>
		<text col_start="9" align="left">'Pénalités Tir :'</text>
		<text col_start="10" col_end="0" align="right" >$(Epreuve.Penalite_tir)..' Sec.'</text>
		
		<!-- mise en place de ligne verticale -->
		<line col_start="4" row_start="-6" row_end="0" pen_color="dkgray" border="mid_vert" />
		<line col_start="8" row_start="-6" row_end="0" pen_color="dkgray" border="mid_vert" />
		
		<row h="auto" />
		<lua>codeClub = $(Evenement.Club)</lua>
		<lua>tClub = base:GetTable('Club')</lua>
		<lua>base:TableLoad(tClub, "Select * From Club Where Nom_reduit = '"..codeClub.."'")</lua>
		<text col_start="1" col_end="4" align="left">'Club organisateur : '..$(Club.Nom_complet)</text>
		<text col_start="6" col_end="10" align="left" >'Organisateur : '..$(Evenement.Organisateur) </text>
		<!-- retour a la ligne de 0.1cm		 -->
		<row h="0.2cm" />
		
		<row h="auto" />
		<text col_start="1" align="left">'Météo : '..$(Epreuve_Nordique.Meteo)</text>
		<text col_start="2" align="left">'Liste : '..$(Evenement.Code_liste)</text>
		<text col_start="5" col_end="6" align="left" >'Codex Epreuve : '..$(Epreuve.Fichier_transfert) </text>
		<text col_start="8" col_end="9" align="left" >'Coéficient F : '..$(Discipline.Facteur_f)</text>
		<text col_start="10" align="left" cond="params.title=='Résultats Officiels'" >'Penalitée : '..$(Epreuve.Penalite_appliquee)</text>
		<!-- <text col_start="10" col_end="0" align="right" ></text> -->
		<line col_start="1" col_end="0" pen_color="dkgray" border="top" />
		<row h="0.1cm" />
		<!-- affichage de la ligne d'heure de départ en massstart ou fond pop -->
		<call option="Ligne_H_depart" cond="editor:GetPageCurrent() == 1" file="./edition/options.xml"/>
		
		<!-- affichage du Compteur des classés si c'est un resultat -->
		<lua>if type_edition == 'res_' then</lua>
			<call option="stat_ranking" cond="editor:GetPageCurrent() == 1" file="./edition/options.xml"/>
		<lua>end </lua>

	</first_header>
	
	<!-- footer standard !-->
	<footer>
		<background mode="transparent"/>
		<font name="Calibri" size="8" adjust="best" weight="normal"/>
		<pen border="none" />

		<lua>entite = entite or $(Evenement.Code_entite)</lua>
		<lua>info = $(Epreuve.Date_epreuve,'%2D/%2M/%4Y')..' / '..$(Evenement.Station)..' ('</lua>
		<lua cond="entite=='FIS'">info = info..$(Evenement.Code_nation)..'-'</lua>
		<lua>info = info..$(Evenement.Code_comite).. ') / '..$(Evenement.Organisateur)</lua>
		<text row="auto" col="1" align="left">info</text>
		<text align="right" font_weight="bold" cond="entite=='FIS'">$(Epreuve.Fichier_transfert_int)..' (Liste n°'..$(Evenement.Code_liste)..')'</text>
		<text align="right" font_weight="bold" cond="entite=='FFS'">$(Epreuve.Fichier_transfert)..' (Liste n°'..$(Evenement.Code_liste)..')'</text>
		<line col_start="1" col_end="0" pen_size="2" pen_color="dkgray" border="bottom"/>
		<!-- <text row="auto" align="left"><pen border="top" />app.GetName()..' Version '..app.GetVersion()..' (FFS - ESF - Agil Informatique) - '..os.date('Edité le %d-%m-%Y à %H:%M:%S')</text> -->
		
		<row h="auto" />
		<matrix col_start="1">
			<row h="auto"/>
			<text col="auto" align="left">app.GetName()..' Version '..app.GetVersion()..' / FFS'</text>
			<image col="0.4cm" adjust="width" align="left">'./res/32x32_ffs.png'</image>
			<text col="auto" align="left" adjust="width">' / ESF'</text>
			<image col="0.4cm" adjust="width" align="left">'./res/32x32_esf.png'</image>
			<text col="auto" align="left">' / Agil Informatique'</text>
			<image col="0.4cm" adjust="width" align="left">'./res/32x32_agil.png'</image>
			<text col="auto" align="left">os.date(' / Edité le %d-%m-%Y à %H:%M:%S')</text>
		</matrix>	
		<text align="right">string.format('Page %d/%s',editor:GetPageCurrent(), editor:GetPageCountLabel())</text>
		<line col_start="1" col_end="0" border="top" />
		<text row="auto" align="left" cond="editor:GetPageCurrent() == 1">$(Evenement.Commentaire)</text>
	</footer>	
	
	<!-- Dossier Homologation-->
	<report id="Homologation" title="Dossier d'Homologation" header="1" >
		<layers>
			<layer id="FFS">
			</layer>
		</layers>
		<margin left="80" top="100" right="80" bottom="20" />
		<lua>
			local tEpreuve = base:GetTable('Epreuve');
			bodyhomologation = tEpreuve:Copy(false);
			
			for i=0, tEpreuve:GetNbRows()-1 do
					bodyhomologation:AddRow();
					sqlTable.CopyRow(bodyhomologation, bodyhomologation:GetNbRows()-1, tEpreuve, i);
			end
			body = bodyhomologation;
			code_activite = $(Evenement.Code_activite);				
			type_edition = id:sub(1,4);
			entite = $(Evenement.Code_entite);
			discipline = $(Epreuve.Code_discipline);
		</lua>
			<order key="Code_epreuve" />
		
		<padding all="2px"/>
		<font name="Calibri" size="10" adjust="best" weight="normal"/>
		<row h="auto"/>
		<row h="auto"/>
		<row h="auto"/>
		<row h="auto"/>
		<header  row_start="1">
			<spacing all="0"/>
			<background mode="transparent"/>
			<font name="Calibri" size="12" adjust="max" weight="bold"/>
			<text row="auto" font_size_step="14" align="center" cond="title" >title</text>
			<text row="auto" font_size_step="10" align="center">$(Evenement.Nom)</text>
			<text row="auto" align="center">' '</text>
			<!-- <text row="auto" align="center" >'Evenement de ski de '..$(Activite{ $(Evenement.Code_activite)}.Libelle)</text> -->
			<text row="auto" align="center">'Du: '..$(Epreuve.Date_epreuve)</text>
			<row h="0.5cm"/>
		</header>
		
		
	<first_header>
			<!-- <background mode="transparent"/> -->
			<font name="Calibri" size="10" adjust="best" weight="normal"/>
			<pen border="none" />
		
			<lua>
				codeClub = $(Club):EscapeQuote();
				tClub = base:GetTable('Club');
				base:TableLoad(tClub, "Select * From Club Where Nom_reduit = '"..$(Evenement.Club):EscapeQuote().."'");

				if $(Epreuve.Style) == 'L' then
					Style = 'Libre';
				elseif $(Epreuve.Style) == 'C' then
					Style = 'Classique';
				elseif $(Epreuve.Style) == 'X' then
					Style = 'Cl+L';
				elseif $(Epreuve.Style) == 'Y' then
					Style = 'L+Cl';
				else
					Style = '';
				end
				
				if $(Epreuve_Nordique.Depart) == 'L' then
					Depart = 'Mass-start.';
				elseif $(Epreuve_Nordique.Depart) == 'I' then
					Depart = 'Individuel';
				elseif $(Epreuve_Nordique.Depart) == 'A' then
					Depart = 'Mode Alpin';
				else
					Depart = '';
				end
			</lua>
					<matrix>
						<col w="1,2,1,1" />
						<row h="auto"/>
							<text col_start="1" col_end="0" align="center" border= "all" >
							<background mode="solid" color="ltgray" />'Parametres Evénement:'
						</text>
						<row h="0.2cm"/>
						<row h="auto"/>
							<text col_start="1" align="left" >'Lieu:'</text>
							<text col_start="2" align="left" >$(Epreuve_Nordique.Lieu)</text>
							<text col_start="3" align="left" >'Station:'</text>
							<text col_start="4" align="left" >$(Evenement.Station)</text>
						<row h="0.2cm" />	
						<row h="auto" />
							<text col_start="1" align="left" >'Club Organisateur: '</text>
							<text col_start="2" align="left" >$(Club.Nom_complet)..'-'..$(Evenement.Code_comite):Parenthesis()</text>
							<text col_start="3" align="left" >'Codex Evt. :'</text>
							<text col_start="4" align="left" >$(Evenement.Codex)</text>	
						<row h="0.2cm"/>
						<row h="auto"/>
						<text col_start="1" align="left" >'Entite: '..$(Epreuve.Code_entite) </text>
						<text col_start="2" align="left" >'Style: '..Style</text>
						<text col_start="3" align="left" >'Départ: '..Depart</text>

						<row h="0.5cm" />	
						<row h="auto"/>
						<text col_start="1" col_end="0" align="center" border= "all" >
							<background mode="solid" color="ltgray" />'Parametres Epreuve:'
						</text>
						<row h="0.5cm"/>
					</matrix>	
			
		</first_header>
				
		<body>
				<call option="couleur_alternee" file="./edition/options.xml" />
				<call option="identite" file="./edition/options.xml"/>
				<font size="9" adjust="ellipsize"/>
				<spacing left="5" right="10" top="2" bottom="2" />
				<row h="auto"/>
				<row h="auto"/>
				<row h="auto"/>
				   <!-- 1,2,3,4,5,6,7,8,9,0,1,2 -->
				<col w="4,2,4,4,4,3,3,3,4,3,4,5" cond="code_activite == 'BIATH'" />
				<col w="4,2,4,4,4,3,3,4,3,4,5" cond="code_activite ~= 'BIATH'" />
				
				<text row_start="1" col_start="1" col_end="0" align="center" border= "all" cond="group =='body'" ><background mode="solid" color="yellow" />'Parametres Epreuve: '..row+1</text>
				 <!-- colonne 1 -->
				<text row_start="2" row_end="0" col_start="1" align="right" label="Regroup.">$(Code_regroupement)</text>
				 <!-- colonne 2 -->
				<text row_start="2" row_end="0" col_start="2" align="right" label="Disc.">$(Code_discipline) </text>
				 <!-- colonne 3 -->
				<text row_start="2" row_end="0" col_start="3" align="center" label="Style">Style</text>
				 <!-- colonne 4 -->
				<text row_start="2" row_end="0" col_start="4" align="right" label="Niveau">$(Code_niveau) </text>
				 <!-- colonne 5 -->
				<text row_start="2" align="right" col_start="5" label="Grille Cat.">$(Code_grille_categorie)</text>
				<text row_start="3" align="right" col_start="5" label="Categ.">$(Code_categorie)</text>
				 <!-- colonne 6 -->
				 <lua>
				if $(Sexe) == 'M' then
					Sexe = 'Masculin'
				elseif $(Sexe) == 'F' then
					Sexe = 'Féminin'
				elseif $(Sexe) == 'T' then
					Sexe = 'Mixte'
				else
					Sexe = 'Autre'
				end
				</lua>
				<text row_start="2" align="right" col_start="6" label="Sexe">Sexe</text>
				<text row_start="3" align="right" col_start="6" label="Distance">$(Distance)..'Km'</text>
				 <!-- colonne 7 -->
				<text row_start="2" align="right" col_start="7" label="P.Haut">$(Point_haut)</text>
				<text row_start="3" align="right" col_start="7" label="P. Bas">$(Point_bas)</text>
				 <!-- colonne 8 -->
				<text row_start="2" align="right" col_start="8" label="Mt.t.">$(Montee_tot)</text>
				<text lua="c=8" row_start="3" align="right" col_start="8" label="Mt.M.">$(Montee_maxi)</text>
				<!-- <col w="4" cond="code_activite == 'BIATH'"  /> -->
				<text lua="c=c+1" row_start="2" align="right" col_start="(c)" label="Tir" cond="code_activite == 'BIATH'" >$(Tir)</text> <!-- cond="code_activite == 'BIATH'"  --> 
				<text row_start="3" align="right" col_start="(c)" label="Pen.Tir." cond="code_activite == 'BIATH'" >$(Penalite_tir)..' Sec.'</text> <!-- cond="code_activite == 'BIATH'" --> 
				 <!-- colonne 10 -->
				<text lua="c=c+1" row_start="2" align="right" col_start="(c)" label="Fact.F">$(Facteur_f)</text>
				<text row_start="3" align="right" col_start="(c)" label="Péna Ap.">$(Penalite_calculee)</text>
				 <!-- colonne 11 -->
				<text lua="c=c+1" row_start="2" row_end="0" col_start="(c)" align="center" label="Codex Epr.">$(Fichier_transfert)</text>
				 <lua>
					local HomologationDT = tonumber($(Code_gestion))
					if HomologationDT == 11 then
						Homologation = 'Non'
					elseif HomologationDT == 12 then
						Homologation = 'Oui'
					else
						Homologation = 'N.Def.'
					end
				</lua>
				 <!-- colonne 12 -->
				<text lua="c=c+1" row_start="2" col_start="(c)" align="left" label="Homolog.">Homologation</text>
				<text row_start="3" col_start="(c)" align="left" label="Date">$(Date_calendrier)</text>
				<row h="0.2cm"/>
				<row h="auto"/>
			</body>			
				
			<end  row_start="4">
			<call option="identiteOfficiel" file="./edition/options.xml"/>
				<col w="2,2,1,1" />	
				<row h="0.3cm"/>
				<row h="auto"/>
					<text  col_start="1" col_end="0" align="center" border= "all" >
						<background mode="solid" color="ltgray" />'Officiels FFS:'
					</text>				
				<row h="auto"/>
					<text col_start="1" align="Left" ><font name="Calibri" size="12" adjust="best" weight="bold"/>'Fonction'</text>
					<text col_start="2" align="Left" ><font name="Calibri" size="12" adjust="best" weight="bold"/>'Identité'</text>
					<text col_start="3" align="Left" ><font name="Calibri" size="12" adjust="best" weight="bold"/>'Code'</text>
					<text col_start="4" align="Left" ><font name="Calibri" size="12" adjust="best" weight="bold"/>'Nation / Comité'</text>
				<row h="auto"/>
					<line col_start="1" col_end="0" pen_color="dkgray" border="top" />
				
						
					<lua>
						TableEvenement_Officiel = base:GetTable('Evenement_Officiel');
							cmd = "Select * From Evenement_Officiel Where Code_evenement = "..$(Evenement.Code)
									.." and Code_epreuve = 1 Order By Ordre"
						NbFonction = base:TableLoad(TableEvenement_Officiel, cmd):GetNbRows();
						Tofficiels = base:TableLoad(TableEvenement_Officiel, cmd)
									
						for m=0, tonumber(NbFonction)-1 do 
					</lua>
						<row h="auto"/>
						<text col_start="1" align="Left" cond="entite=='FFS'">base:GetOfficielAttribute(Tofficiels:GetCell('Fonction', m), 'label')</text>
						<text col_start="1" align="Left" cond="entite=='FIS'">Tofficiels:GetCell('label_inter', m)</text>
						<text col_start="2" align="Left" >Tofficiels:GetCell('Nom', m):upper()..' '..Tofficiels:GetCell('Prenom', m):sub(1,1):upper()..Tofficiels:GetCell('Prenom', m):sub(2):lower()</text>
						<text col_start="3" align="Left" >Tofficiels:GetCell('Code_coureur', m)</text>
						<text col_start="4" align="Left" >Tofficiels:GetCell('Nation', m)</text>
						
					<lua>
						end
					</lua>
				<row h="0.3cm"/>
				<row h="auto"/>
					<text  col_start="1" col_end="0" align="center" border= "all" >
						<background mode="solid" color="ltgray" />'Homologation:'
					</text>	
				<row h="0.3cm"/>
				<lua>
					TableEpreuveTransfert = base:GetTable('Epreuve_Transfert');
						cmd3 = "Select * From Epreuve_Transfert Where Code_evenement = "..$(Evenement.Code)
					accident = base:TableLoad(TableEpreuveTransfert, cmd3):GetCell('Declaration_accident', 0);
					commentaire =  base:TableLoad(TableEpreuveTransfert, cmd3):GetCell('Commentaire', 0);
					dt_code = base:GetOfficiel('TECHNICALDELEGATE', 'Code_coureur'):sub(4)
					if accident == 'O' then
						Declarationaccident = 'Oui';
					elseif accident == 'N' then
						Declarationaccident = 'Non';
					else
						Declarationaccident = 'test';
					end
					TableEvenementTransfert = base:GetTable('Evenement_Transfert');
						cmd4 = "Select * From Evenement_Transfert Where Code_evenement = "..$(Evenement.Code)
					IdentiteResTransmission = base:TableLoad(TableEvenementTransfert, cmd4):GetCell('Nom_transmetteur', 0)..' / '..base:TableLoad(TableEvenementTransfert, cmd4):GetCell('Qualite_transmetteur', 0);
				</lua>
				<row h="auto"/>
					<text col_start="1" col_end="0" align="Left" >'Cet événement à t\'il fait l\'objet d\'une déclaration d\'accident: '..Declarationaccident</text>
				<row h="auto"/>
					<text col_start="1" col_end="2" align="Left" >'Commentaire  du DT: '</text>
					<text col_start="3" col_end="0" align="Left" >'Signature DT'</text>
				<row h="2cm"/>
					<text col_start="1" col_end="1" align="Left" border="all" >commentaire</text>
					<text col_start="3" col_end="0" align="Left" border="all" >GetIdentiteOfficiels('TechnicalDelegate')..' - '..dt_code</text>

		</end>
			
</report>	
	
<!-- Edition partipants  -->	

	<!-- Liste Par Ordre Alpha -->
	<report id="part_officiel" title="('Liste des partipants '..params.title or '')" header="1" first_header="0" rupture="0">
		<order key="Identite Asc" />
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<row h="auto"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">NOM_Prenom</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>

	<!-- Liste Par Ordre points -->
	<report id="part_officiel_points" title="('Liste des partipants '..params.title or '')" header="1" first_header="0" rupture="(params.rupture)">
		<order key="Point Asc ,Dossard Asc, Identite Asc" />
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<row h="auto"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">NOM_Prenom</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>
	
	<!-- Liste Par Nation Comite Club -->
	<report id="participants" title="('Liste des participants \n'..params.title)" header="1" first_header="0">
		<lua>page_break = tonumber(params.page_break) or 0;
			 entite = $(Evenement.Code_entite);
			 body:SetCounter(params.orderby);
		</lua>
		
		<order key="(params.orderby..',Nom,Prenom')" />
	
		<rupture key="(params.orderby)">
			<before>
				<pagebreak cond="page_break == 1 and row ~= 0" />
				<font name="Calibri" size="16"/>
				<row h="0.5cm" />
				<lua>codeClub = $(Club):EscapeQuote()</lua>
				<lua>tClub = base:GetTable('Club')</lua>
				<lua>base:TableLoad(tClub, "Select * From Club Where Nom_reduit = '"..codeClub.."'")</lua>
				<lua>code = body:GetCell(params.orderby, row);</lua>
				<text row="auto" col="1" cond="params.orderby == 'Club' and code:len() &gt; 0">$(Club.Nom_complet)..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="params.orderby == 'Nation' and code:len() &gt; 0">code..' - '..$(Nation{code}.Libelle)..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="params.orderby == 'Comite' and code:len() &gt; 0">code..' - '..$(Comite{code}.Nom)..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="code:len() &gt; 0">''</text>
			</before>
		</rupture>
		
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<row h="auto"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">NOM_Prenom</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" >$(Point)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>
		
	<!-- Liste Par Epreuve -->
	<report id="part_epreuve" title="Liste des participants par Epreuve " header="1" first_header="0">
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>discipline = $(Epreuve.Code_discipline)</lua>
		<lua>body:SetCounter('Code_epreuve')</lua>
		<order key="Code_epreuve,Identite" />

		<rupture key="Code_epreuve">	
			<before>
				<row h="0.3cm"/>
				<font name="Calibri" size="13"/>
				<lua>epr = $(Code_epreuve)</lua>
				<lua>cat = $(Epreuve{epr}.Code_categorie)</lua>
				<lua>HeureDepartEpr = $(Epreuve{epr}.Heure_depart)</lua>
				<lua>NomEpr = $(Categorie{cat}.Libelle)..' / '..$(Epreuve{epr}.Distance)..'Km'</lua>
				<text row="auto" col="1">'Epreuve : '..NomEpr..' ('..body:GetCounterValue('Code_epreuve', epr)..') Départ théorique à '..HeureDepartEpr</text>
				<row h="0.2cm"/>
			</before>
		</rupture>

		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<row h="auto"/>
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">NOM_Prenom</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>
	
	<!-- Listes de départ officiels -->
	<report id="lst_officielle" title="Liste de Départ Officielle" header="1" first_header="(params.first_header or '1')" >
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>discipline = $(Epreuve.Code_discipline)</lua>
		<order key="Heure_depart1, Dossard, Identite" />

		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<lua>LabelCode = $(Code_coureur):sub(1,3)</lua>
			<row h="auto"/>
			<text col="0.5cm" font_size="6" align="center" label="Pb">$(Modif_manuel) </text>
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<lua>
				if tonumber(params.officiel) == 0 then
			</lua>	
			<text col="15" align="left" label="Prénom - Nom" >Prenom_NOM</text> 	
			<lua>else
					if LabelCode == 'FFS' then </lua>
						<text col="18" align="left" label="Nom - Prénom" >NOM_PRENOM</text> 
					<lua>elseif LabelCode == 'EXT' then </lua>
						<text col="18" align="left" label="nom - prenom" >nom_prenom</text>
					<lua>elseif LabelCode == 'LCN' then </lua>
						<text col="18" align="left" label="nom - prenom" >NOM_PRENOM</text>
					<lua>elseif LabelCode == 'TIC' then </lua>
						<text col="18" align="left" label="Prénom - Nom" >NOM_Prenom</text>
					<lua>else</lua>
						<text col="18" align="left" label="Prénom - Nom" >Prenom_NOM</text> 
					<lua> end 
				end	
			</lua>  
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<text col="9" align="right" label="H. Départ" cond="discipline:In('FS','KO_QLF')">$(Heure_depart1)</text>
			<text col="11" align="right" label="H. Départ Pours" cond="discipline:In('POURS')">$(Heure_depart2)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>

	<!-- Listes de départ officiels poursuite-->
	<report id="lst_officielle_pours" title="Liste de Départ Officielle" header="1" first_header="1" >
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>discipline = $(Epreuve.Code_discipline)</lua>
		<lua>rang = 'Rang'..manche</lua>
		<lua>Hdpt = 'Heure_depart'..manche</lua>
		<order key="(Hdpt), Dossard, Identite" />

		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<row h="auto"/>
			<text col="4" align="right" label="Rg.">$(Rang2) </text>
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">NOM_Prenom</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<text col="9" align="right" label="H. Départ" cond="discipline:In('FS','KO_QLF')">$(Heure_depart1)</text>
			<text col="11" align="right" label="H. Dépt. Pours" cond="discipline:In('POURS') and manche>=2">$(Heure_depart2)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>

	<!-- Liste de départ officielle par Nation Comite Club -->
	<report id="lst_officielle_Filtrer" title="(params.title or '')" header="1" first_header="0">
		<lua>page_break = tonumber(params.page_break) or 0;
			 discipline = $(Epreuve.Code_discipline)
			 entite = $(Evenement.Code_entite);
			 body:SetCounter(params.orderby);
		</lua>
		
		<order key="(params.orderby..', Dossard')" />
	
		<rupture key="(params.orderby)">
			<before>
				<pagebreak cond="page_break == 1 and row ~= 0" />
				<font name="Calibri" size="16"/>
				<row h="0.5cm" />
				<lua>
					codeClub = $(Club):EscapeQuote()
					tClub = base:GetTable('Club')
					base:TableLoad(tClub, "Select * From Club Where Nom_reduit = '"..codeClub.."'")
					code = body:GetCell(params.orderby, row);
					if $(Club.Nom_complet) == '' then 
						CodeClub = code;
					else 
						CodeClub = $(Club.Nom_complet);
					end
				</lua>
				<text row="auto" col="1" cond="params.orderby == 'Club' and code:len() &gt; 0">CodeClub..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="params.orderby == 'Nation' and code:len() &gt; 0">code..' - '..$(Nation{code}.Libelle)..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="params.orderby == 'Comite' and code:len() &gt; 0">code..' - '..$(Comite{code}.Nom)..' ('..body:GetCounterValue(params.orderby, code)..')'</text>
				<text row="auto" col="1" cond="code:len() &gt; 0">''</text>
			</before>
		</rupture>
		
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<row h="auto"/>
			<text col="0.5cm" font_size="6" align="center" label="Pb">$(Modif_manuel) </text>
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">$(Identite)</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS" cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<text col="9" align="right" label="H. Départ" cond="discipline:In('FS','POURS', 'KO_QLF')">$(Heure_depart1)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>
		
	<!-- Liste de départ officielle par epreuve -->
	<report id="lst_officielle_epreuve" title="(params.title or '')" header="1" first_header="1">
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>discipline = $(Epreuve.Code_discipline)</lua>
		<lua>body:SetCounter('Code_epreuve')</lua>
		<order key="Code_epreuve,Dossard" />

		<rupture key="Code_epreuve">	
			<before>
				<row h="0.3cm"/>
				<font name="Calibri" size="13"/>
				<lua>epr = $(Code_epreuve)</lua>
				<lua>cat = $(Epreuve{epr}.Code_categorie)</lua>
				<lua>HeureDepartEpr = $(Epreuve{epr}.Heure_depart)</lua>
				<lua>NomEpr = $(Categorie{cat}.Libelle)..' / '..$(Epreuve{epr}.Distance)..'Km'</lua>
				<text row="auto" col="1">'Epreuve : '..NomEpr..' ('..body:GetCounterValue('Code_epreuve', epr)..') Départ théorique à '..HeureDepartEpr</text>
				<row h="0.2cm"/>
			</before>
		</rupture>
		
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="10" top="2" bottom="2" />
			<row h="auto"/>
			<text col="4" align="right" label="Dos">$(Dossard) </text>
			<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<text col="20" align="left" label="Nom - Prénom">$(Identite)</text> 
			<text col="4" align="center" label="An">$(An)</text>
			<text col="6" align="center" label="Categ">$(Categ)</text>
			<text col="4" align="center" label="S.">$(Sexe)</text>
			<text col="4" align="center" label="Dist.">$(Distance)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="4" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="left" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Points" cond="entite == 'FFS'">$(Point)</text>
			<text col="9" align="right" label="H. Départ" cond="discipline:In('FS','POURS', 'KO_QLF')">$(Heure_depart1)</text>
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
	</report>

<!-- Résultats  -->
	<!-- Résultats Officiels, Officieux ou Provisoires -->
	<report id="res_officiel" title="(params.title or '')" header="1" first_header="(params.first_header or '1')" >
		
		<column name="Tps_status">chrono.Status(body:GetCellInt('Tps', row))</column>
		<lua>type_edition = id:sub(1,4)</lua>
		<lua>body:SetCounter('Tps_status')</lua>
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>nb_manche = base:GetTable('Epreuve'):GetCellInt('Nombre_de_manche', 0, 1)</lua>	
		<order key="Tps, Dossard Desc" />
		
		<rupture key="Tps_status">
			<before cond="$(Tps_status) ~= 'ok'">
				<font size="14"/>
				<lua>local status = $(Tps_status)</lua>
				<row h="0.5cm"/>
				<text row="auto" col="1" >ranking.Code(status)..' - '..ranking.Label(status)..' ('..body:GetCounterValue('Tps_status', status)..')'</text>
				<row h="0.2cm"/>
			</before>
		</rupture>

		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font name="calibri" size="9" adjust="ellipsize" />
			<spacing all="2" />
			<spacing left="7" right="10" top="2" bottom="2" />
			<lua>LabelCode = $(Code_coureur):sub(1,3)</lua>
			<row h="auto"/><font color="Red" cond="$(Sexe) == 'F'"/>
			<text col="3" align="center" label="Clt" font_weight="bold" font_size_step="1"> $(Clt)</text>
			<text col="3" align="right" label="D." font_size_step="-1">$(Dossard)</text>
			<text col="9" align="right" label="Clt /Cat / S."><font size_step="-1" cond="group=='body'"/>$(Cltc)..' /'..$(Categ)..' /'..$(Sexe)..' '</text>
			<text col="7" align="center" label="Code"><font size_step="-2" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<lua>
				if tonumber(params.officiel) == 0 then
			</lua>	
			<text col="15" align="left" label="Prénom - Nom" >Prenom_NOM</text> 	
			<lua>else
					if LabelCode == 'FFS' then </lua>
						<text col="18" align="left" label="Nom - Prénom" >NOM_PRENOM</text> 
					<lua>elseif LabelCode == 'EXT' then </lua>
						<text col="18" align="left" label="nom - prenom" >nom_prenom</text>
					<lua>elseif LabelCode == 'LCN' then </lua>
						<text col="18" align="left" label="nom - prenom" >NOM_PRENOM</text>
					<lua>elseif LabelCode == 'TIC' then </lua>
						<text col="18" align="left" label="Prénom - Nom" >NOM_Prenom</text>
					<lua>else</lua>
						<text col="18" align="left" label="Prénom - Nom" >Prenom_NOM</text> 
					<lua> end 
				end	
			</lua>  
			<text col="4" align="center" label="An" font_size_step="-2">$(An)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="3" align="center" label="CS." cond="entite == 'FFS'" font_size_step="-1">$(Comite)</text>
			<text col="12" align="center" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<text col="6" align="right" label="Chrono" font_size_step="-2">$(Tps_chrono1)</text> 
			<text col="7" align="center" label="Pénalité" font_size_step="-2">$(Penalite1)..' '</text>
			<text col="6" align="right" label="T.Pena" font_size_step="-2">$(Tps_penalite1)..' '</text>
			<text col="6" align="right" label="T.Bonus" font_size_step="-2">$(Tps_bonus1)..' '</text>
			<text col="7" align="right" label="Tps." font_weight="bold" font_size_step="1">$(Tps1)</text> 
			<text col="5" align="right" label="Ecart" font_style="italic" font_size_step="-2">$(Diff1)</text>  
			<text col="5" align="right" label="Note" cond="params.title=='Résultats Officiels'" font_size_step="-2">$(Note)</text> 
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
		
		<end cond="params.title=='Résultats Officiels'">
			<lua>sqlBase.FixationTableRanking(body)</lua>
		</end>
	</report>
	
		<!-- Résultats Officiels, poursuite 2eme jour-->
	<report id="res_off_Pours" title="(params.title or '')" header="1" first_header="(params.first_header or '1')" >
		<column name="Tps_status">chrono.Status(body:GetCellInt('Tps2', row))</column>
		<lua>type_edition = id:sub(1,4)</lua>
		<lua>body:SetCounter('Tps2_status')</lua>
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>nb_manche = base:GetTable('Epreuve'):GetCellInt('Nombre_de_manche', 0, 1)</lua>
		<lua>nb_inter = tonumber($(Epreuve_Nordique.Nb_temps_inter))</lua>
		<order key="Tps2, Dossard Desc" />
		
		<rupture key="Tps_status">
			<before cond="$(Tps_status) ~= 'ok'">
				<font size="14"/>
				<lua>local status = $(Tps_status)</lua>
				<row h="0.5cm"/>
				<text row="auto" col="1" >ranking.Code(status)..' - '..ranking.Label(status)..' ('..body:GetCounterValue('Tps_status', status)..')'</text>
				<row h="0.2cm"/>
			</before>
		</rupture>

		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<call option="identite" file="./edition/options.xml"/>
			<font name="calibri" size="9" adjust="ellipsize" />
			<spacing all="2" />
			<spacing left="7" right="10" top="2" bottom="2" />
			<lua>LabelCode = $(Code_coureur):sub(1,3)</lua>
			<row h="auto"/><font color="Red" cond="$(Sexe) == 'F'"/>
			<text col="4" align="center" label="Clt" font_weight="bold" font_size_step="1"> $(Clt2)</text>
			<text col="3" align="right" label="Dos">$(Dossard)</text>
			<text col="9" align="right" label="Clt /Cat / S."><font size_step="-1" cond="group=='body'"/>$(Cltc2)..' /'..$(Categ)..' /'..$(Sexe)..' '</text>
			<text col="7" align="center" label="Code"><font size_step="-2" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
			<lua>
				if tonumber(params.officiel) == 0 then
			</lua>	
			<text col="15" align="left" label="Prénom - Nom" >Prenom_NOM</text> 	
			<lua>else
					if LabelCode == 'FFS' then </lua>
						<text col="18" align="left" label="Nom - Prénom" >NOM_PRENOM</text> 
					<lua>elseif LabelCode == 'EXT' then </lua>
						<text col="18" align="left" label="nom - prenom" >nom_prenom</text>
					<lua>elseif LabelCode == 'LCN' then </lua>
						<text col="18" align="left" label="nom - prenom" >NOM_PRENOM</text>
					<lua>elseif LabelCode == 'TIC' then </lua>
						<text col="18" align="left" label="Prénom - Nom" >NOM_Prenom</text>
					<lua>else</lua>
						<text col="18" align="left" label="Prénom - Nom" >Prenom_NOM</text> 
					<lua> end 
				end	
			</lua>  
			<text col="4" align="center" label="An">$(An)</text>
			<text col="4" align="center" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
			<text col="3" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
			<text col="12" align="center" label="Club" cond="entite == 'FFS'">$(Club)</text>
			<lua>for m=1,nb_inter do</lua>
				<text col="7" align="right" label="('Tps2_i'..m)" cond="nb_inter ~= 1"><font size_step="-1" cond="group == 'body'" />body:GetCell('Tps2_inter'..m,row)</text> 
			<lua>end</lua>
			<text col="6" align="left" label="Chrono" ><font size_step="-1" />$(Tps_chrono2)</text> 
			<text col="7" align="right" label="Pénalité" font_size_step="-1">$(Penalite2)..' '</text>
			<text col="7" align="right" label="Tps." font_weight="bold" font_size_step="1">$(Tps2)</text> 
			<text col="5" align="right" label="Ecart" font_style="italic">$(Diff2)</text>  
			<text col="6" align="right" label="Note">$(Note)</text> 
			<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
		</body>
		
		<!-- <end cond="params.title=='Résultats Officiels'"> -->
			<!-- <lua>sqlBase.FixationTableRanking(body)</lua> -->
			<!-- <call option="signature_dt" file="./edition/options.xml" /> -->
		<!-- </end> -->
	</report>
	
	<!-- Résultats Par Catégories -->
	<report id="res_categ" title="Résultats par Catégories" first_header="0">
		<lua>entite = $(Evenement.Code_entite)</lua>
		<lua>nb_manche = base:GetTable('Epreuve'):GetCellInt('Nombre_de_manche', 0, 1)</lua>
		<order key="Code_epreuve, Sexe, Categ, Tps, Dossard Desc" />

		<rupture key="Code_epreuve">
			<before>
				<lua>epr = $(Code_epreuve)</lua>
				<lua>cat = $(Epreuve{epr}.Code_categorie)</lua>
				<lua>NomEpr = $(Categorie{cat}.Libelle)..' / '..$(Epreuve{epr}.Distance)..'Km'</lua>
				<font size="16"/>
				<row h="0.6cm"/>
				<text row="auto" col="1" align="left" ><font color="red" />$(Code_epreuve)..' -> '..NomEpr</text>
			</before>
		</rupture>

		<rupture key="Sexe">
			<before>
				<!-- <font size="14"/> -->
				<!-- <row h="0.1cm"/> -->
				<!-- <text row="auto" col="1" ></text> -->
				<lua>SexeEpr = $(Sexe)</lua>
			</before>
		</rupture>

		<rupture key="Categ">
			<before>
				<font size="14"/>
				<row h="0.4cm"/>
				<text row="auto" col="1" >$(Categ)..' -> '..$(Categorie{$(Categ)}.Libelle)..' -> '..$(Sexe{SexeEpr}.Libelle)</text>
			</before>
		</rupture>

		<body>
			<lua>clt = body:GetCellInt('Cltc',row,9999)</lua>
			<lua>if clt &lt;= params.clt_max then</lua>
				<call option="couleur_alternee" file="./edition/options.xml"/>
				<call option="identite" file="./edition/options.xml"/>
				<font size="8" adjust="ellipsize"/>
				<spacing left="5" right="10" top="2" bottom="2" />
				<row h="auto" />
				<text col="5" align="right" label="C.Cat" font_weight="bold" font_size_step="1">$(Cltc)</text>
				<text col="5" align="right" label="C.Tot" font_weight="bold" font_size_step="1">$(Clte)</text>
				<text col="4" align="right" label="Dos">$(Dossard)</text>
				<text col="7" align="center" label="Code"><font size="8" cond="group =='body'"/>$(Code_coureur):sub(4)</text>
				<text col="20" align="left" label="Prénom - Nom" font_weight="bold">Prenom_NOM</text> 
				<text col="4" align="center" label="An">$(An)</text>
				<text col="6" align="left" label="Nat" cond="entite == 'FIS'">$(Nation)</text>
				<image col_start="0" adjust="height" align="right" border="0" cond="entite == 'FIS'"><background mode="transparent"/>app.ImageNation($(Nation))</image> 
				<text col="3" align="center" label="CS." cond="entite == 'FFS'">$(Comite)</text>
				<text col="12" align="center" label="Club" cond="entite == 'FFS'">$(Club)</text>
				<text col="6" align="right" label="Tps1" ><font size_step="-1" />$(Tps_chrono1)</text> 
				<text col="6" align="right" label="Pénalité" font_size_step="-1">$(Penalite1)</text>
				<text col="8" align="right" label="Tps.Tot" font_weight="bold" font_size_step="1">$(Tps1)</text> 
				<text col="5" align="right" label="Ecart" font_style="italic">$(Diff1)</text> 
				<line col_start="1" col_end="0" pen_size="4" border="bottom" cond="not _context_border"/>
			<lua>end</lua>
		</body>
	</report>
	
	<!-- Résultats multi epreuve poursuite -->
	<report id="res_epr2" title="Résultats épreuve poursuite" first_header="0" >
		<column name="Tps_status">chrono.Status(body:GetCellInt('Tps', row))</column>
		<lua>body:SetCounter('Tps_status')</lua>
		<order key="Tps, Dossard Desc" />
		<lua>_context_border = true</lua>
		
		<rupture key="Tps_status">
			<before cond="$(Tps_status) ~= 'ok'">
				<font size="14"/>
				<lua>local status = $(Tps_status)</lua>
				<row h="0.5cm"/>
				<text row="auto" col="1" >ranking.Code(status)..' - '..ranking.Label(status)..' ('..body:GetCounterValue('Tps_status', status)..')'</text>
				<row h="0.2cm"/>
			</before>
		</rupture>
		
		<label>
			<row h="0.2cm" />
			<row h="auto" />
			<row h="auto" />
			<font weight="bold" />
			<pen border="all" size="1" />
			<text row_start="2"  row_end="0" col="3" align="center">'Clt'</text>
			<text col="12" />
			<background mode="transparent" />
			<text row_start="2" align="left" >'Identité'</text> 
			<text row_start="2" align="right" >'Code_coureur'</text>
			<background mode="solid" />
			<text row_start="3" align="left" >'Club - (Comite)'</text> 
			<text col="5" />
			<background mode="transparent" />
			<text row_start="2" align="left" >'Cat.'</text> 
			<text row_start="2" align="right" >'(Cltc.)'</text>
			<background mode="solid" />
			<text row_start="3" align="center" >'Sexe - An.'</text>
			<text row_start="2"  row_end="0" col="7" align="center">'Epreuve(s)'</text>
			<text row_start="2"  row_end="0" col="4" align="center">'Penalitée'</text>
			<text row_start="2"  row_end="0" col="6" align="center">'Tps Epreuve'</text>
			<text row_start="2"  row_end="0" col="6" align="center">'Total'</text>
			<text row_start="2"  row_end="0" col="6" align="center">'Ecart'</text>
			<row h="0.3cm" />
		</label>
		
		<body>
			<call option="couleur_alternee" file="./edition/options.xml" />
			<font size="9" adjust="ellipsize"/>
			<spacing left="5" right="15" top="2" bottom="2" />
			<row h="auto"/>
			<row h="auto"/>
			
			<text col="3" row_start="1" row_end="0" align="right" font_weight="bold" font_size_step="1"><background mode="solid" color="green" cond="$(Clt) == '1'" /><font color="white" cond="$(Clt) == '1'"/>$(Clt)</text>
	
			<col w="12"/>
			<text row_start="1">''</text> 
			<background mode="transparent" />
			<text row_start="1" align="left" >$(Identite)</text> 
			<text row_start="1" align="right" >$(Code_coureur):sub(4)</text> 
			<background mode="solid" />
			<text row_start="2" align="left" >$(Club)..' - '..$(Comite{$(Comite)}.Nom):Parenthesis()</text> 
			<col w="5"/>
			<text row_start="1" align="center" >$(Categ)..' - '..$(Cltc):Parenthesis()</text> 
			<text row_start="2" align="center" >$(Sexe)..' - '..$(An)</text> 

		<lua>if $(Epreuve.Style) == 'L' then Style = 'Libre' styleprolog = Style stylepours = ''</lua>
		<lua>elseif $(Epreuve.Style) == 'C' then Style = 'Classique' styleprolog = Style stylepours = ''</lua>
		<lua>elseif $(Epreuve.Style) == 'X' then Style = 'Classique + Libre' styleprolog = 'Classique' stylepours = 'Libre' </lua>
		<lua>elseif $(Epreuve.Style) == 'Y' then Style = 'Libre + Classique' styleprolog = 'Libre' stylepours = 'Classique' </lua>
		<lua>end </lua>

			<col w="7" />
			<text row_start="1" align="left" >'Epr. 1 :'..styleprolog:Parenthesis()</text> 
			<text row_start="2" align="left" >'Pours. :'..stylepours:Parenthesis()</text> 
	
			<col w="4" />
			<text row_start="1" align="center" font_size_step="-2"><background mode="solid" color="yellow" cond="$(Clt1) == '1'" />$(Penalite1)</text> 
			<text row_start="2" align="center" font_size_step="-2"><background mode="solid" color="yellow" cond="$(Clt2) == '1'" />$(Penalite2)</text> 
		
			<col w="6" />
			<text row_start="1" align="center" font_size_step="-2"><background mode="solid" color="yellow" cond="$(Clt1) == '1'" />$(Tps1)..' '..$(Clt1):Parenthesis()</text> 
			<text row_start="2" align="center" font_size_step="-2"><background mode="solid" color="yellow" cond="$(Clt2) == '1'" />$(Tps2)..' '..$(Clt2):Parenthesis()</text> 
	
			
	
			<text col="6" row_start="1" row_end="0" align="right" font_weight="bold" font_size_step="1"><background mode="solid" color="green" cond="$(Clt) == '1'" /><font color="white" cond="$(Clt) == '1'"/>$(Tps)</text> 
			
			<text col="6" row_start="1" row_end="0" align="right" font_weight="bold" font_size_step="1">$(Diff)</text> 
			<row h="0.2cm"/>
		</body>
	</report>
	
<!-- Utilitaires  -->
<!-- utilitaire permetant de faire un recap du nombre d'inscrit dans l'evenements -->
		<report id="uti_recapilatif" title="Nombre de participants" >
			<!-- header simplifier !-->
			<header>
				<spacing all="0"/>
				<background mode="transparent"/>
				<font name="Calibri" size="14" adjust="max" weight="bold"/>
				<text row="auto" col="1" align="center">$(Evenement.Nom)</text>
				<!-- <text row="auto" align="center">$(Discipline.Libelle)</text> -->
				<!-- <text row="auto" align="center">$(Categorie{$(Epreuve.Code_categorie)}.Libelle)..' - '..$(Sexe{$(Epreuve.Sexe)}.Libelle)</text> -->
				<text row="auto" align="center" cond="title" >title</text>
				<row h="0.5cm"/>
			</header>
			<first_header />
			<!-- <background mode="transparent" /> -->
			<lua>entite = $(Evenement.Code_entite)</lua>
			<lua>body:SetCounter('Distance,Sexe,Categ', 'recap')</lua>
			<lua>body:SetCounter('Distance')</lua>
			<lua>body:SetCounter('Distance,Sexe', 'sex')</lua>
			<order key="Distance, Sexe, Categ" />
			
				<lua>counter = body:GetCounter('recap')</lua>
				<lua>counter1 = body:GetCounter('Distance')</lua>
				<lua>counter2 = body:GetCounter('sex')</lua>
				<!-- <lua>counter:OrderBy('0,1')</lua> -->
				
				<end>
					<!-- Par Distance -->
					<text row="auto" col_start="1" col_end="0" border="1" align="center">'Récapitulatif par Distance'</text>
					<row h="0.3cm"/>
					<lua>for i=0, counter1:GetNbRows()-1 do </lua>
					<text row="auto" col_start="1" col_end="0">
							'distance '..counter1:GetCell(0,i)..' Km => '..counter1:GetCell('_count_',i)..'Inscrits'
						</text>
					<lua>sex = counter:GetCell(1,i)</lua> 
					<lua>dista = counter1:GetCell(0,i)</lua>
							<lua>for y=0, counter2:GetNbRows()-1 do </lua>
								<lua>if counter2:GetCell(0,y) == dista and counter2:GetCell(1,y) == 'F' then </lua>
									<lua>nbDamesT = counter2:GetCell('_count_',y)</lua>
										<text row="auto" col_start="1" col_end="0">
									'           Avec '..nbDamesT..' Dames'
									</text>
								
								<lua>elseif counter2:GetCell(0,y) == dista and counter2:GetCell(1,y) == 'M' then </lua>
									<lua>nbHommesT = counter2:GetCell('_count_',y)</lua>
								<text row="auto" col_start="1" col_end="0">
									'           Avec '..nbHommesT..' Hommes'
									</text>
								<lua>else </lua>
									
								<lua>end</lua>						
							<lua>end</lua>
						
						
						<row h="0.1cm"/>
					<lua>end</lua>
					<row h="1cm"/>
					
					<!-- Distance, Sexe, Categ -->
					<text row="auto" col_start="1" col_end="0" border="1" align="center">'Récapitulatif par Distance / sexe / Catégories'</text>
					<row h="0.3cm"/>
					<lua>for i=0, counter:GetNbRows()-1 do </lua>
						<!-- <lua>sexe = counter:GetCell(0,i)</lua> -->
						<!-- <lua>categ = counter:GetCell(1,i)</lua> -->
						<!-- <lua>dist = counter:GetCell(2,i)</lua> -->
						<!-- <lua>nb = counter:GetCell(3,i)</lua> -->
						<lua>sexe = $(Sexe{counter:GetCell('Sexe',i)}.Libelle)</lua>
						<lua>categ = $(Categorie{counter:GetCell('Categ',i)}.Libelle)</lua>
						<lua>dist = counter:GetCell('Distance',i)</lua>
						<lua>nb = counter:GetCell('_count_',i)</lua>
							<matrix row="auto" col_start="1" col_end="0" align="center" >
							<call option="couleur_alternee" file="./edition/options.xml" />
							<!-- <col w="10, 0.2cm,5, 0.2cm,5, 0.2cm,5" /> -->
								<row h="auto" />
								<lua> if dist == counter:GetCell('Distance',i-1) then </lua>
									<text col_start="1" col="10" align="left" border ="0">''</text>
								<lua> else </lua>
								<text col_start="1" col="10" align="left" >'distance: '..dist..'Km'</text>
								<lua> end </lua>
								<lua> if counter:GetCell('Sexe',i) == counter:GetCell('Sexe',i-1) then </lua>
								<text col_start="2" col="10" align="left" border ="0" >''</text>
								<lua> else </lua>
								<text col_start="2" col="10" align="left">'Sexe: '..sexe</text>
								<lua> end </lua>
								<text col_start="3" col="10" align="left">'Catégorie: '..categ</text>
								<lua> if counter:GetCell('Sexe',i) == 'F' then </lua>
								<text col_start="4" col="10" align="left">'Inscrite(s): '..nb</text>
								<lua> else </lua>
								<text col_start="4" col="10" align="left">'Inscrit(s): '..nb</text>
								<lua> end </lua>
								<row h="0.2cm"/>
							</matrix>
						<row h="0.1cm"/>	
				<lua>end</lua>
					<!-- Par sexe -->
						<!-- <text row="auto" col_start="1" col_end="0">'Racap par Sexe'</text> -->
						<!-- <lua>for i=0, body:GetCounter('Sexe'):GetNbRows()-1 do </lua> -->
							<!-- <text row="auto" col_start="1" col_end="0"> -->
								<!-- body:GetCounter('Sexe'):GetCell(0,i)..'='..body:GetCounter('Sexe'):GetCell(1,i) -->
							<!-- </text> -->
						<!-- <lua>end</lua>	 -->

				</end>
		</report>	
				
		<report id="uti_podium" title="Podium par épreuve" >
			<!-- header simplifier !-->
			<header>
				<spacing all="0"/>
				<background mode="transparent"/>
				<font name="Calibri" size="14" adjust="max" weight="bold"/>
				<text row="auto" col="1" align="center">$(Evenement.Nom)</text>
				<text row="auto" align="center" cond="title" >title</text>
				<row h="0.5cm"/>
			</header>
			<first_header />
			<order key="Tps, Dossard Desc" />
			
			<!-- <background mode="transparent" /> -->
			<lua>entite = $(Evenement.Code_entite)</lua>	
					<end>
						
						<lua>Liste_Epreuve = base:GetTable("Epreuve")</lua>
						<lua>for i=0, Liste_Epreuve:GetNbRows()-1 do</lua>
							<lua>catepr = $(Categorie{base:GetTable("Epreuve"):GetCell('Code_categorie',i)}.Libelle)</lua>
							<lua>codeepr = base:GetTable("Epreuve"):GetCell('Code_epreuve',i)</lua>
							<lua>sexepr = $(Sexe{base:GetTable("Epreuve"):GetCell('Sexe',i)}.Libelle)</lua>
							<lua>Distepr = base:GetTable("Epreuve"):GetCell('Distance',i)</lua>
							<text row="auto" col_start="1" col_end="0" border="1" align="center">'podium de epreuve : '..catepr..' // distance = '..Distepr..' Km '..sexepr</text>
							<row h="0.3cm"/>
							
								<matrix row="auto" col_start="1" col_end="0" align="center" >
									<lua>steph = base:GetTable("body")</lua>
											<lua>for i=0, steph:GetNbRows()-1 do</lua>
												<lua>if steph:GetCell('Code_epreuve',i) == codeepr and steph:GetCell('Clte',i) == '1' then </lua>
												<matrix row="auto" col_start="1" col_end="0" align="center" >
													<row h="auto" />
													<text col_start="1" col="15" align="left">'1er : '..sexepr..': '..base:GetTable("body"):GetCell('Identite',i)</text>
													<text col_start="2" col="10" align="left">'Temps : '..base:GetTable("body"):GetCell('Tps',i)</text>
													<text col_start="3" col="10" align="left">'Club : '..base:GetTable("body"):GetCell('Club',i)</text>
													<text col_start="4" col="10" align="left">'Ville : '..base:GetTable("body"):GetCell('Ville',i)</text>
													</matrix>
												<lua>end</lua>
												<lua>if base:GetTable("body"):GetCell('Code_epreuve',i) == codeepr and base:GetTable("body"):GetCell('Clte',i) == '2' then </lua>
													<matrix row="auto" col_start="1" col_end="0" align="center" >
													<row h="auto" />
													<text col_start="1" col="15" align="left">'2ème : '..sexepr..': '..base:GetTable("body"):GetCell('Identite',i)</text>
													<text col_start="2" col="10" align="left">'Temps : '..base:GetTable("body"):GetCell('Tps',i)</text>
													<text col_start="3" col="10" align="left">'Club : '..base:GetTable("body"):GetCell('Club',i)</text>
													<text col_start="4" col="10" align="left">'Ville : '..base:GetTable("body"):GetCell('Ville',i)</text>
													</matrix>
												<lua>end</lua>
												<lua>if base:GetTable("body"):GetCell('Code_epreuve',i) == codeepr and base:GetTable("body"):GetCell('Clte',i) == '3' then </lua>
													<matrix row="auto" col_start="1" col_end="0" align="center" >
													<row h="auto" />
													<text col_start="1" col="15" align="left">'3ème : '..sexepr..': '..base:GetTable("body"):GetCell('Identite',i)</text>
													<text col_start="2" col="10" align="left">'Temps : '..base:GetTable("body"):GetCell('Tps',i)</text>
													<text col_start="3" col="10" align="left">'Club : '..base:GetTable("body"):GetCell('Club',i)</text>
													<text col_start="4" col="10" align="left">'Ville : '..base:GetTable("body"):GetCell('Ville',i)</text>
													</matrix>
												<lua>end</lua>
												
												
											<lua>end</lua>
											<row h="0.3cm"/>
								</matrix>
								
						<lua>end</lua>
			
					</end>
			
		</report>
</edition>

